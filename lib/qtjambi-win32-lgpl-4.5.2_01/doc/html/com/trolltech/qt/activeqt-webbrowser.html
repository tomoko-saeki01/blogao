<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Web Browser Example (ActiveQt)</title><link href="classic.css" rel="stylesheet" type="text/css" />
</head><table border="0" cellpadding="0" cellspacing="0" width="100%">
 <tr>
 <td align="left" valign="top" width="32"> <img src="images/qt-logo.png" align="left" width="32" height="32" border="0" /> </td>
 <td width="1">&nbsp;&nbsp;</td> <td class="postheader" valign="center"> <a href="qtjambi-index.html"> <font color="#004faf">Home</font></a>&nbsp;&middot; <a href="qtjambi-examples.html"> <font color="#004faf">Examples</font></a>&nbsp; </td>
 </tr></table><body><p><hr><p><center><h1>Web Browser Example (ActiveQt)</h1></center><p> The Web Browser example uses the Microsoft Web Browser ActiveX control to implement a fully functional Web Browser application. The user interface has been developed using the Qt Designer integration of the QAxWidget class. <p>The code demonstrates how the Qt application can communicate with the embedded ActiveX controls using signals, slots and the dynamicCall() function.<br><br>The following code example is written in c++.<br> <pre class="snippet">
class MainWindow : public QMainWindow, public Ui::MainWindow
{
    Q_OBJECT
public:
    MainWindow();

public slots:
    void on_WebBrowser_TitleChange(const QString &title);
    void on_WebBrowser_ProgressChange(int a, int b);
    void on_WebBrowser_CommandStateChange(int cmd, bool on);
    void on_WebBrowser_BeforeNavigate();
    void on_WebBrowser_NavigateComplete(QString);

    void on_actionGo_triggered();
    void on_actionNewWindow_triggered();
    void on_actionAbout_triggered();
    void on_actionAboutQt_triggered();
    void on_actionFileClose_triggered();

private:
    QProgressBar *pb;
};
</pre> The <tt>MainWindow</tt> class declares a <tt>QMainWindow</tt> based user interface, using the <tt>Ui::MainWindow</tt> class generated by Qt Designer. A number of slots are implemented to handle events from the various user interface elements, including the <tt>WebBrowser</tt> object, which is a QAxWidget hosting the Microsoft Web Browser control.<br><br>The following code example is written in c++.<br> <pre class="snippet">

MainWindow::MainWindow()
{
    setupUi(this);

    connect(addressEdit, SIGNAL(returnPressed()), actionGo, SLOT(trigger()));
    connect(actionBack, SIGNAL(triggered()), WebBrowser, SLOT(GoBack()));
    connect(actionForward, SIGNAL(triggered()), WebBrowser, SLOT(GoForward()));
    connect(actionStop, SIGNAL(triggered()), WebBrowser, SLOT(Stop()));
    connect(actionRefresh, SIGNAL(triggered()), WebBrowser, SLOT(Refresh()));
    connect(actionHome, SIGNAL(triggered()), WebBrowser, SLOT(GoHome()));
    connect(actionSearch, SIGNAL(triggered()), WebBrowser, SLOT(GoSearch()));

    pb = new QProgressBar(statusBar());
    pb-&gt;setTextVisible(false);
    pb-&gt;hide();
    statusBar()-&gt;addPermanentWidget(pb);

    WebBrowser-&gt;dynamicCall("GoHome()");
}

</pre> The constructor initializes the user interface, installs a progress bar on the status bar, and uses QAxBase::dynamicCall() to invoke the <tt>GoHome()</tt> method of Internet Explorer to navigate to the user's home page.<br><br>The following code example is written in c++.<br> <pre class="snippet">
void MainWindow::on_WebBrowser_TitleChange(const QString &title)
{
    setWindowTitle("Qt WebBrowser - " + title);
}

void MainWindow::on_WebBrowser_ProgressChange(int a, int b)
{
    if (a &lt;= 0 || b &lt;= 0) {
	pb-&gt;hide();
	return;
    }
    pb-&gt;show();
    pb-&gt;setRange(0, b);
    pb-&gt;setValue(a);
}

void MainWindow::on_WebBrowser_CommandStateChange(int cmd, bool on)
{
    switch (cmd) {
    case 1:
	actionForward-&gt;setEnabled(on);
	break;
    case 2:
	actionBack-&gt;setEnabled(on);
	break;
    }
}

void MainWindow::on_WebBrowser_BeforeNavigate()
{
    actionStop-&gt;setEnabled(true);
}

void MainWindow::on_WebBrowser_NavigateComplete(QString)
{
    actionStop-&gt;setEnabled(false);
}

</pre> Different slots handle the signals emitted by the WebBrowser object. <p>Connections that don't require any coding, i.e. connecting the <tt>back</tt> action to the <tt>GoBack()</tt> slot, have already been made in Qt Designer.<br><br>The following code example is written in c++.<br> <pre class="snippet">
void MainWindow::on_actionGo_triggered()
{
    WebBrowser-&gt;dynamicCall("Navigate(const QString&)", addressEdit-&gt;text());
}

void MainWindow::on_actionNewWindow_triggered()
{
    MainWindow *window = new MainWindow;
    window-&gt;show();
    if (addressEdit-&gt;text().isEmpty())
	return;
    window-&gt;addressEdit-&gt;setText(addressEdit-&gt;text());
    window-&gt;actionStop-&gt;setEnabled(true);
    window-&gt;on_actionGo_triggered();
}

void MainWindow::on_actionAbout_triggered()
{
    QMessageBox::about(this, tr("About WebBrowser"),
		tr("This Example has been created using the ActiveQt integration into Qt Designer.\n"
		   "It demonstrates the use of QAxWidget to embed the Internet Explorer ActiveX\n"
		   "control into a Qt application."));
}

void MainWindow::on_actionAboutQt_triggered()
{
    QMessageBox::aboutQt(this, tr("About Qt"));
}

void MainWindow::on_actionFileClose_triggered()
{
    close();
}

#include "main.moc"


int main(int argc, char ** argv)
{
    QApplication a(argc, argv);
    MainWindow w;
#if defined(Q_OS_WINCE)
    w.showMaximized();
#else
    w.show();
#endif
    return a.exec();
}
</pre> The rest of the implementation is not related to <a href="activeqt.html">ActiveQt</a> - the actions are handled by different slots, and the entry point function starts the application using standard Qt APIs. <p>To build the example you must first build the <a href="qaxcontainer.html">QAxContainer</a> library. Then run your make tool in <tt>examples/activeqt/webbrowser</tt> and run the resulting <tt>webbrowser.exe</tt>.<p /><address><hr /><div align="center">
 <table width="100%" cellspacing="0" border="0"><tr class="address">
 <td width="30%">Copyright &copy; 2009 Nokia Corporation and/or its subsidiary(-ies)</td>
 <td width="40%" align="center"><a href="trademarks.html">Trademarks</a></td>
 <td width="30%" align="right"><div align="right">Qt Jambi 4.5.2_01</div></td>
 </tr></table></div></address></body></html>
