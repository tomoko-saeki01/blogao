<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>What's New in Qt 4</title><link href="classic.css" rel="stylesheet" type="text/css" />
</head><table border="0" cellpadding="0" cellspacing="0" width="100%">
 <tr>
 <td align="left" valign="top" width="32"> <img src="images/qt-logo.png" align="left" width="32" height="32" border="0" /> </td>
 <td width="1">&nbsp;&nbsp;</td> <td class="postheader" valign="center"> <a href="qtjambi-index.html"> <font color="#004faf">Home</font></a>&nbsp;&middot; <a href="qtjambi-examples.html"> <font color="#004faf">Examples</font></a>&nbsp; </td>
 </tr></table><body><p><hr><p><center><h1>What's New in Qt 4</h1></center><p>[Next: <a href="qt4-tulip.html">The Tulip Container Classes</a>]<p> This document covers the most important differences between Qt 3 and Qt 4. Although it is not intended to be a comprehensive porting guide, it tells you about the most important portability issues that you may encounter. It also explains how to turn on Qt 3 compatibility support. <ul><li> <a href="#new-technologies-in-qt-4">New Technologies in Qt 4</a></li><li> <a href="#recent-additions-to-qt-4">Recent Additions to Qt 4</a></li><li> <a href="#significant-improvements">Significant Improvements</a></li><li> <a href="#build-system">Build System</a></li><li> <a href="#include-syntax">Include Syntax</a></li><li> <a href="#namespaces">Namespaces</a></li><li> <a href="#qobject-qwidget-constructors">QObject/QWidget Constructors</a></li><li> <a href="#dynamic-casts">Dynamic Casts</a></li><li> <a href="#qpointer-t">QPointer<T></a></li><li> <a href="#paint-events">Paint Events</a></li><li> <a href="#qt-3-support-layer">Qt 3 Support Layer</a></li></ul><a name="new-technologies-in-qt-4"><h2>New Technologies in Qt 4</h2> Qt 4 introduces the following core technologies: <ul><li> <a href="qt4-tulip.html">Tulip</a>, a new set of template container classes.</li><li> <a href="qt4-interview.html">Interview</a>, a model/view architecture for item views.</li><li> <a href="qt4-arthur.html">Arthur</a>, the Qt 4 painting framework.</li><li> <a href="qt4-scribe.html">Scribe</a>, the Unicode text renderer with a public API for performing low-level text layout.</li><li> <a href="qt4-mainwindow.html">Mainwindow</a>, a modern action-based mainwindow, toolbar, menu, and docking architecture.</li><li> The new <a href="qt4-designer.html">Qt Designer</a>Qt Designer user interface design tool.</li></ul><a name="recent-additions-to-qt-4"><h2>Recent Additions to Qt 4</h2> The following features have been added to Qt since the first release of Qt 4: <p>In Qt 4.4: <ul><li> <a href="qtwebkit.html">Qt WebKit integration</a>, making it possible for developers to use a fully-featured Web browser to display documents and access online services.</li><li> A multimedia API provided by the <a href="phonon-overview.html">Phonon Multimedia Framework</a>.</li><li> <a href="qtxmlpatterns.html">XQuery and XPath</a> support, providing facilities for XML processing beyond that supported by the <a href="qtxml.html">QtXml</a> module.</li><li> Support for embedded widgets in <a href="graphicsview.html">Graphics View</a> scenes.</li><li> The <a href="threading.html">QtConcurrent framework</a> for concurrent programming using Qt paradigms and threading features.</li><li> An <a href="qthelp.html">improved help system</a> that can be used in conjunction with Qt Assistant or as an independent help resource manager.</li><li> Printing system improvements, including the <a href="../../../com/trolltech/qt/gui/QPrinterInfo.html">QPrinterInfo</a>, <a href="../../../com/trolltech/qt/gui/QPrintPreviewWidget.html">QPrintPreviewWidget</a> and <a href="../../../com/trolltech/qt/gui/QPrintPreviewDialog.html">QPrintPreviewDialog</a> classes.</li><li> Support for <a href="wince-with-qt-introduction.html">Qt for Windows CE</a> as a mainstream Qt platform.</li><li> Improvements in performance of Qt for Embedded Linux and extended support for display hardware.</li></ul> In Qt 4.3: <ul><li> Support for different <a href="qt4-mainwindow.html">main window paradigms and styles</a>, such as those found in Visual Studio or KDevelop.</li><li> The <a href="qtscript.html">QtScript</a> module, providing support for application scripting with ECMAScript.</li><li> Improved graphics features, including an experimental Direct3D paint engine and improved provision for hardware accelerated rendering with OpenGL, and support for OpenGL ES in Qt for Embedded Linux.</li><li> <a href="../../../com/trolltech/qt/svg/QSvgGenerator.html">Scalable Vector Graphics (SVG) export</a>, allowing SVG drawings to be created using the standard <a href="../../../com/trolltech/qt/gui/QPainter.html">QPainter</a> API.</li><li> Support for arbitrary matrix transformations and set operations on painter paths.</li><li> Native look and feel on Windows Vista; improved look and feel on Mac OS X.</li><li> An improved <a href="../../../com/trolltech/qt/gui/QMdiArea.html">Multiple Document Interface (MDI)</a> implementation.</li><li> Continuous improvements to Qt Designer, including support for <a href="designer-widget-mode.html#the-property-editor">dynamic properties</a>.</li><li> Support for Secure Socket Layer (SSL) communications via the <a href="../../../com/trolltech/qt/network/QSslSocket.html">QSslSocket</a> class.</li><li> Support for XML Localization Interchange File Format (XLIFF) files in Qt Linguist.</li><li> A new font subsystem for Qt for Embedded Linux.</li></ul> In Qt 4.2: <ul><li> The <a href="graphicsview.html">Graphics View</a> framework for producing interactive graphics.</li><li> <a href="desktop-integration.html">Desktop integration</a> facilities for applications.</li><li> <a href="qtjambi-stylesheet.html">Qt Style Sheets</a> enable easy, yet powerful customization of user interfaces.</li><li> Support for the <a href="intro-to-dbus.html">D-Bus</a> Inter-Process Communication (IPC) and Remote Procedure Calling (RPC) mechanism.</li><li> An <a href="demos-undo.html">Undo framework</a> based on the <a href="guibooks.html#design-patterns">Command pattern</a>.</li><li> Support for model-based <a href="../../../com/trolltech/qt/gui/QCompleter.html">text completion</a> in standard and custom widgets.</li><li> New widgets and GUI features, such as <a href="../../../com/trolltech/qt/gui/QCalendarWidget.html">QCalendarWidget</a> and <a href="../../../com/trolltech/qt/opengl/QGLFramebufferObject.html">QGLFramebufferObject</a>.</li><li> Classes to provide higher level application infrastructure, such as <a href="../../../com/trolltech/qt/core/QFileSystemWatcher.html">QFileSystemWatcher</a> and <a href="../../../com/trolltech/qt/gui/QDataWidgetMapper.html">QDataWidgetMapper</a>.</li></ul> In Qt 4.1: <ul><li> Integrated support for rendering <a href="qt4-arthur.html#svg-rendering-support">Scalable Vector Graphics</a> (SVG) drawings and animations.</li><li> Support for <a href="../../../com/trolltech/qt/gui/QWidget.html">child widget transparency</a> on all platforms.</li><li> A Portable Document Format (PDF) backend for Qt's printing system.</li><li> A <a href="qtestlib-manual.html">unit testing framework</a> for Qt applications and libraries.</li><li> Modules for <a href="qtdesigner.html">extending Qt Designer</a>Qt Designer and <a href="qtuitools.html">dynamic user interface building</a>.</li><li> New <a href="model-view-proxy-models.html">proxy models</a> to enable view-specific sorting and filtering of data displayed using item views.</li><li> Support for <a href="install-mac.html">universal binaries</a> on Mac OS X.</li><li> Additional features for developers using <a href="qtopengl.html">OpenGL</a>, such as support for pixel and sample buffers.</li><li> A flexible <a href="../../../com/trolltech/qt/gui/QSyntaxHighlighter.html">syntax highlighting class</a> based on the <a href="qt4-scribe.html">Scribe</a> rich text framework.</li><li> Support for <a href="../../../com/trolltech/qt/network/QNetworkProxy.html">network proxy</a> servers using the SOCKS5 protocol.</li><li> Support for OLE verbs and MIME data handling in <a href="activeqt.html">ActiveQt</a>.</li></ul> For more information about improvements in the current release, see the detailed list of changes.<a name="significant-improvements"><h2>Significant Improvements</h2> The following modules have been significantly improved for Qt 4: <ul><li> A fully cross-platform <a href="accessibility.html">accessibility</a> module, with support for the emerging SP-API Unix standard in addition to Microsoft and Mac Accessibility.</li><li> The <a href="qt4-sql.html">SQL module</a>, which is now based on the Interview model/view framework.</li><li> The <a href="qt4-network.html">network module</a>, with better support for UDP and synchronous sockets.</li><li> The <a href="qt4-styles.html">style API</a>, which is now decoupled from the widgets, meaning that you can draw any user interface element on any device (widget, pixmap, etc.).</li><li> Enhanced <a href="qt4-threads.html">thread support</a>, with signal-slot connections across threads and per-thread event loops.</li><li> A new <a href="resources.html">resource system</a> for embedding images and other resource files into the application executable.</li></ul><a name="build-system"><h2>Build System</h2> Unlike previous Qt releases, Qt 4 is a collection of smaller libraries: <table align="center" border="0" cellpadding="2" cellspacing="1"><thead><tr class="qt-style" valign="top"><th><center> Library</center></th><th><center> Description</center></th></tr></thead><tr valign="top" class="even"><td> <a href="qtcore.html">QtCore</a></td><td> Core non-GUI functionality</td></tr><tr valign="top" class="odd"><td> <a href="qtgui.html">QtGui</a></td><td> Core GUI functionality</td></tr><tr valign="top" class="even"><td> <a href="qtnetwork.html">QtNetwork</a></td><td> Network module</td></tr><tr valign="top" class="odd"><td> <a href="qtopengl.html">QtOpenGL</a></td><td> OpenGL module</td></tr><tr valign="top" class="even"><td> <a href="qtsql.html">QtSql</a></td><td> SQL module</td></tr><tr valign="top" class="odd"><td> <a href="qtsvg.html">QtSvg</a></td><td> SVG rendering classes</td></tr><tr valign="top" class="even"><td> <a href="qtxml.html">QtXml</a></td><td> XML module</td></tr><tr valign="top" class="odd"><td> <a href="qt3support.html">Qt3Support</a></td><td> Qt 3 support classes</td></tr><tr valign="top" class="even"><td> <a href="qaxcontainer.html">QAxContainer</a></td><td> <a href="activeqt.html">ActiveQt</a> client extension</td></tr><tr valign="top" class="odd"><td> <a href="qaxserver.html">QAxServer</a></td><td> <a href="activeqt.html">ActiveQt</a> server extension</td></tr><tr valign="top" class="even"><td> <a href="qtassistant.html">QtAssistant</a></td><td> Classes for launching Qt Assistant</td></tr><tr valign="top" class="odd"><td> <a href="qtdesigner.html">QtDesigner</a></td><td> Classes for extending and embedding Qt Designer</td></tr><tr valign="top" class="even"><td> <a href="qtuitools.html">QtUiTools</a></td><td> Classes for dynamic GUI generation</td></tr><tr valign="top" class="odd"><td> <a href="qttest.html">QtTest</a></td><td> Tool classes for unit testing</td></tr></table> <a href="qtcore.html">QtCore</a> contains tool classes like QString, QList, and <a href="../../../com/trolltech/qt/core/QFile.html">QFile</a>, as well as kernel classes like <a href="../../../com/trolltech/qt/core/QObject.html">QObject</a> and <a href="../../../com/trolltech/qt/core/QTimer.html">QTimer</a>. The <a href="../../../com/trolltech/qt/gui/QApplication.html">QApplication</a> class has been refactored so that it can be used in non-GUI applications. It is split into <a href="../../../com/trolltech/qt/core/QCoreApplication.html">QCoreApplication</a> (in <a href="qtcore.html">QtCore</a>) and <a href="../../../com/trolltech/qt/gui/QApplication.html">QApplication</a> (in <a href="qtgui.html">QtGui</a>). <p>This split makes it possible to develop server applications using Qt without linking in any unnecessary GUI-related code and without requiring GUI-related system libraries to be present on the target machine (e.g. Xlib on X11, Carbon on Mac OS X). <p>If you use qmake to generate your makefiles, qmake will by default link your application against <a href="qtcore.html">QtCore</a> and <a href="qtgui.html">QtGui</a>. To remove the dependency upon <a href="qtgui.html">QtGui</a>, add the line <pre class="snippet">
QT -= gui
</pre> to your .pro file. To enable the other libraries, add the line <pre class="snippet">
QT += network opengl sql qt3support
</pre> Another change to the build system is that moc now understands preprocessor directives. qmake automatically passes the defines set for your project (using "DEFINES +=") on to moc, which has its own built-in C++ preprocessor. <p>To compile code that uses .ui files, you will also need this line in the .pro file: <pre class="snippet">
CONFIG += uic3
</pre><a name="include-syntax"><h2>Include Syntax</h2> The syntax for including Qt class definitions has become <pre class="snippet">
#include &lt;QClassName&gt;
</pre> For example: <pre class="snippet">
#include &lt;QString&gt;
#include &lt;QApplication&gt;
#include &lt;QSqlTableModel&gt;
</pre> This is guaranteed to work for any public Qt class. The old syntax, <pre class="snippet">
#include &lt;qclassname.h&gt;
</pre> still works, but we encourage you to switch to the new syntax. <p>If you attempt to include a header file from a library that isn't linked against the application, this will result in a compile-time warning (e.g., "<a href="../../../com/trolltech/qt/sql/QSqlQuery.html">QSqlQuery</a>: No such file or directory"). You can remedy to this problem either by removing the offending include or by specifying the missing library in the QT entry of your <tt>.pro</tt> file (see <a href="buildsystem.html">Build System</a> above). <p>To include the definitions for all the classes in a library, simply specify the name of that library. For example: <pre class="snippet">
#include &lt;QtCore&gt;
</pre><a name="namespaces"><h2>Namespaces</h2> Qt 2 introduced a class called Qt for global-like constants (e.g., <tt>Qt::yellow</tt>). The C++ namespace construct was not used because not all compilers understood it when it was released. <p>With Qt 4, the Qt class has become the Qt namespace. If you want to access a constant that is part of the Qt namespace, prefix it with <tt>Qt:</tt>: (e.g., <tt>Qt::yellow</tt>), or add the directive <pre class="snippet">
using namespace Qt;
</pre> at the top of your source files, after your <tt>#include</tt> directives. If you use the <tt>using namespace</tt> syntax you don't need the prefix (e.g., <tt>yellow</tt> is sufficient). <p>When porting Qt 3 applications, you may run into some source compatibility problems with some of these symbols. For example, in Qt 3, it was legal to write <tt>QWidget::yellow</tt> instead of <tt>Qt::yellow</tt>, because <a href="../../../com/trolltech/qt/gui/QWidget.html">QWidget</a> inherited from Qt. This won't work in Qt 4; you must write <tt>Qt::yellow</tt> or add the "using namespace" directive and drop the <tt>Qt:</tt>: prefix. <p>The <a href="qt3to4.html">qt3to4</a> porting tool automates this conversion.<a name="qobject-qwidget-constructors"><h2>QObject/QWidget Constructors</h2> In Qt 4 we have tried to simplify the constructors of <a href="../../../com/trolltech/qt/core/QObject.html">QObject</a>/<a href="../../../com/trolltech/qt/gui/QWidget.html">QWidget</a> subclasses. This makes subclassing easier, at the same time as it helps make the Qt library more efficient. <p>Constructors no longer take a "const char *name" parameter. If you want to specify a name for a <a href="../../../com/trolltech/qt/core/QObject.html">QObject</a>, you must call <a href="../../../com/trolltech/qt/core/QObject.html#setObjectName(java.lang.String)">QObject::setObjectName()</a> after construction. The object name is now a QString. The reasons for this change are: <ul><li> Code that used it looked confusing, for example: <pre class="snippet">
QLabel *label1 = new QLabel("Hello", this);
QLabel *label2 = new QLabel(this, "Hello");
</pre> <tt>label1</tt> is a <a href="../../../com/trolltech/qt/gui/QLabel.html">QLabel</a> that displays the text "Hello"; <tt>label2</tt> is a <a href="../../../com/trolltech/qt/gui/QLabel.html">QLabel</a> with no text, with the object name "Hello".</li><li> From surveys we did, most users didn't use the name, although they blindly followed Qt's convention and provided a "const char *name" in their subclasses's constructors. For example: <pre class="snippet">
MyWidget::MyWidget(QWidget *parent, const char *name)
    : QWidget(parent, name)
{
    ...
}
</li></pre><li> The name parameter was in Qt since version 1, and it always was documented as: "It is not very useful in the current version of Qt, but it will become increasingly important in the future." Ten years later, it still hasn't fulfilled its promise.</li></ul> <a href="../../../com/trolltech/qt/gui/QWidget.html">QWidget</a>'s <tt>WFlags</tt> data type has been split in two: Qt::WindowFlags specifies low-level window flags (the type of window and the frame style), whereas <a href="../../../com/trolltech/qt/core/Qt.WidgetAttribute.html">Qt::WidgetAttribute</a> specifies various higher-level attributes about the widget (e.g., WA_StaticContents). Widget attributes can be set at any time using <a href="../../../com/trolltech/qt/gui/QWidget.html#setAttribute(com.trolltech.qt.core.Qt.WidgetAttribute)">QWidget::setAttribute()</a>; low-level window flags can be passed to the <a href="../../../com/trolltech/qt/gui/QWidget.html">QWidget</a> constructor or set later using <a href="../../../com/trolltech/qt/gui/QWidget.html#setParent(com.trolltech.qt.gui.QWidget)">QWidget::setParent()</a>. As a consequence, the constructors of most <a href="../../../com/trolltech/qt/gui/QWidget.html">QWidget</a> subclasses don't need to provide a <tt>WFlags</tt> parameter. <p>The parent parameter of all <a href="../../../com/trolltech/qt/core/QObject.html">QObject</a> classes in Qt defaults to a 0 pointer, as it used to do in Qt 1. This enables a style of programming where widgets are created without parents and then inserted in a layout, at which point the layout automatically reparents them.<a name="dynamic-casts"><h2>Dynamic Casts</h2> Qt 4 provides a qobject_cast&lt;&gt;() function that performs a dynamic cast based on the meta-information generated by moc for <a href="../../../com/trolltech/qt/core/QObject.html">QObject</a> subclasses. Unlike the standard C++ <a href="qt4-intro.html#dynamic-cast">dynamic_cast</a>&lt;&gt;() construct, qobject_cast&lt;&gt;() works even when RTTI is disabled, and it works correctly across DLL boundaries. <p>Here's the Qt 3 idiom to cast a type to a subtype: <pre class="snippet">
// DEPRECATED
if (obj-&gt;inherits("QPushButton")) {
    QPushButton *pushButton = (QPushButton *)obj;
    ...
}
</pre> The Qt 4 idiom is both cleaner and safer, because typos will always result in compiler errors: <pre class="snippet">
QPushButton *pushButton = qobject_cast&lt;QPushButton *&gt;(obj);
if (pushButton) {
    ...
}
</pre><a name="qpointer-t"><h2>QPointer<T></h2> The QPointer&lt;T&gt; class provides a pointer to type T (where T inherits from <a href="../../../com/trolltech/qt/core/QObject.html">QObject</a>) that is automatically set to 0 when the referenced object is destroyed. Guarded pointers are useful whenever you want to store a pointer to an object you do not own. <p>Example: <pre class="snippet">
QLabel *label = new QLabel;
QPointer&lt;QLabel&gt; safeLabel = label;
safeLabel-&gt;setText("Hello world!");
delete label;
// safeLabel is now 0, whereas label is a dangling pointer
</pre> QPointer&lt;T&gt; is more or less the same as the old QGuardedPtr&lt;T&gt; class, except that it is now implemented in a much more lightweight manner than before. The cost of one QPointer&lt;T&gt; object is now approximately the same as that of a signal--slot connection.<a name="paint-events"><h2>Paint Events</h2> Qt 4 supports double buffering transparently on all platforms. This feature can be turned off on a per-widget basis by calling QWidget::setAttribute(<a href="../../../com/trolltech/qt/core/Qt.WidgetAttribute.html">Qt::WA_PaintOnScreen</a>). <p>A consequence of this is that all painting must now be done from the paintEvent() function. This is also required by the HIView API on Mac OS X. In practice, this is seldom a problem, since you can call update() from anywhere in your code to create a paint event, with the region to update as the argument. <p>To help porting, <a href="../../../com/trolltech/qt/gui/QWidget.html">QWidget</a> supports a <a href="../../../com/trolltech/qt/core/Qt.WidgetAttribute.html">Qt::WA_PaintOutsidePaintEvent</a> attribute that can be set to make it possible to paint outside <a href="../../../com/trolltech/qt/gui/QWidget.html#paintEvent(com.trolltech.qt.gui.QPaintEvent)">paintEvent()</a> on Windows and X11.<a name="qt-3-support-layer"><h2>Qt 3 Support Layer</h2> Qt 4 provides an extension library that applications based on Qt 3, called <a href="qt3support.html">Qt3Support</a>, that Qt applications can link against. This allows for more compatibility than ever before, without bloating Qt. <ul><li> Classes that have been replaced by a different class with the same name, such as <a href="../../../com/trolltech/qt/gui/QListView.html">QListView</a>, and classes that no longer exist in Qt 4 are available with a <tt>3</tt> in their name (e.g., Q3ListView, Q3Accel).</li><li> Other classes provide compatibility functions. Most of these are implemented inline, so that they don't bloat the Qt libraries.</li></ul> To enable the Qt 3 support classes and functions, add the line <pre class="snippet">
QT += qt3support
</pre> to your <tt>.pro</tt> file. <p>On Visual C++ 7 and GCC 3.2+, using compatibility functions often results in a compiler warning (e.g., "'find' is deprecated"). If you want to turn off that warning, add the line <pre class="snippet">
DEFINES += QT3_SUPPORT
</pre> to your <tt>.pro</tt> file. <p>If you want to use compatibility functions but don't want to link against the <a href="qt3support.html">Qt3Support</a> library, add the line <pre class="snippet">
DEFINES += QT3_SUPPORT_WARNINGS
</pre> or <pre class="snippet">
DEFINES += QT3_SUPPORT
</pre> to your <tt>.pro</tt> file, depending on whether you want compatibility function calls to generate compiler warnings or not.<p /><address><hr /><div align="center">
 <table width="100%" cellspacing="0" border="0"><tr class="address">
 <td width="30%">Copyright &copy; 2009 Nokia Corporation and/or its subsidiary(-ies)</td>
 <td width="40%" align="center"><a href="trademarks.html">Trademarks</a></td>
 <td width="30%" align="right"><div align="right">Qt Jambi 4.5.2_01</div></td>
 </tr></table></div></address></body></html>
