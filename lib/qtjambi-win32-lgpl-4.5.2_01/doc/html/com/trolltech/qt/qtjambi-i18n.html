<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Internationalization with Qt</title><link href="classic.css" rel="stylesheet" type="text/css" />
</head><table border="0" cellpadding="0" cellspacing="0" width="100%">
 <tr>
 <td align="left" valign="top" width="32"> <img src="images/qt-logo.png" align="left" width="32" height="32" border="0" /> </td>
 <td width="1">&nbsp;&nbsp;</td> <td class="postheader" valign="center"> <a href="qtjambi-index.html"> <font color="#004faf">Home</font></a>&nbsp;&middot; <a href="qtjambi-examples.html"> <font color="#004faf">Examples</font></a>&nbsp; </td>
 </tr></table><body><p><hr><p><center><h1>Internationalization with Qt</h1></center><p>Information about Qt jambi's support for internationalization and multiple languages.<a name="internationalization"><a name="i18n"> The internationalization of an application is the process of making the application usable by people in countries other than one's own. <ul><li> <a href="#step-by-step">Step by Step</a></li> <ul><li> <a href="#use-tr-for-all-literal-text">Use tr() for All Literal Text</a></li><li> <a href="#use-qkeysequence-for-accelerator-values">Use QKeySequence() for Accelerator Values</a></li><li> <a href="#produce-translations">Produce Translations</a></li><li> <a href="#localize">Localize</a></li></ul><li> <a href="#dynamic-translation">Dynamic Translation</a></li></ul> In some cases internationalization is simple, for example, making a US application accessible to Australian or British users may require little more than a few spelling corrections. But to make a US application usable by Japanese users, or a Korean application usable by German users, will require that the software operate not only in different languages, but use different input techniques, character encodings and presentation conventions. <p>Qt Jambi tries to make internationalization as painless as possible for developers. All input widgets and text drawing methods in Qt Jambi offer built-in support for all supported languages. The built-in font engine is capable of correctly and attractively rendering text that contains characters from a variety of different writing systems at the same time. <p>Qt supports most languages in use today, in particular: <ul><li> All East Asian languages (Chinese, Japanese and Korean)</li><li> All Western languages (using Latin script)</li><li> Arabic</li><li> Cyrillic languages (Russian, Ukrainian, etc.)</li><li> Greek</li><li> Hebrew</li><li> Thai and Lao</li><li> All scripts in Unicode 4.0 that do not require special processing</li></ul> On Windows, Unix/X11 with FontConfig (client side font support) and Qt for Embedded Linux the following languages are also supported: <ul><li> Bengali</li><li> Devanagari</li><li> Dhivehi (Thaana)</li><li> Gujarati</li><li> Gurmukhi</li><li> Kannada</li><li> Khmer</li><li> Malayalam</li><li> Myanmar</li><li> Syriac</li><li> Tamil</li><li> Telugu</li><li> Tibetan</li></ul> Many of these writing systems exhibit special features: <ul><li> <b>Special line breaking behavior.</b> Some of the Asian languages are written without spaces between words. Line breaking can occur either after every character (with exceptions) as in Chinese, Japanese and Korean, or after logical word boundaries as in Thai.</li><li> <b>Bidirectional writing.</b> Arabic and Hebrew are written from right to left, except for numbers and embedded English text which is written left to right. The exact behavior is defined in the Unicode Technical Annex #9.</li><li> <b>Non-spacing or diacritical marks (accents or umlauts in European languages).</b> Some languages such as Vietnamese make extensive use of these marks and some characters can have more than one mark at the same time to clarify pronunciation.</li><li> <b>Ligatures.</b> In special contexts, some pairs of characters get replaced by a combined glyph forming a ligature. Common examples are the fl and fi ligatures used in typesetting US and European books.</li></ul> Qt Jambi tries to take care of all the special features listed above. You usually don't have to worry about these features so long as you use Qt Jambi's input widgets (e.g. <a href="../../../com/trolltech/qt/gui/QLineEdit.html">QLineEdit</a>, <a href="../../../com/trolltech/qt/gui/QTextEdit.html">QTextEdit</a>, and derived classes) and Qt Jambi's display widgets (e.g. <a href="../../../com/trolltech/qt/gui/QLabel.html">QLabel</a>). <p>Support for these writing systems is transparent to the programmer and completely encapsulated in <a href="richtext.html">Qt Jambi's text engine</a>. This means that you don't need to have any knowledge about the writing system used in a particular language, except for the following small points: <ul><li> QPainter::drawText(int x, int y, const QString &str) will always draw the string with its left edge at the position specified with the x, y parameters. This will usually give you left aligned strings. Arabic and Hebrew application strings are usually right aligned, so for these languages use the version of drawText() that takes a <a href="../../../com/trolltech/qt/core/QRect.html">QRect</a> since this will align in accordance with the language.</li><li> When you write your own text input controls, use QFontMetrics::charWidth() to determine the width of a character in a string. In some languages (e.g. Arabic or languages from the Indian subcontinent), the width and shape of a glyph changes depending on the surrounding characters. Writing input controls usually requires a certain knowledge of the scripts it is going to be used in. Usually the easiest way is to subclass <a href="../../../com/trolltech/qt/gui/QLineEdit.html">QLineEdit</a> or <a href="../../../com/trolltech/qt/gui/QTextEdit.html">QTextEdit</a>.</li></ul> The following sections give some information on the status of the internationalization (i18n) support in Qt Jambi. See also the <a href="qtjambi-linguist-manual.html">Qt Linguist manual</a>.<a name="step-by-step"><h2>Step by Step</h2> Writing cross-platform international software with Qt Jambi is a gentle, incremental process. Your software can become internationalized in the following stages:<a name="use-tr-for-all-literal-text"><h3>Use tr() for All Literal Text</h3> Wherever your program uses "quoted text" for text that will be presented to the user, ensure that it is processed by the <a href="../../../com/trolltech/qt/core/QCoreApplication.html#translate(java.lang.String, java.lang.String, java.lang.String)">QCoreApplication::translate()</a> function. Essentially all that is necessary to achieve this is to use QtJambiObject::tr(). For example: <pre class="snippet">
        public LoginWidget()
        {
            QLabel abel = new QLabel(tr("Password:"));
            ...
        }
</pre> This accounts for 99% of the user-visible strings you're likely to write. <p>If the quoted text is not in a member function of a QtJambiObject subclass, use either the <a href="../../../com/trolltech/qt/core/QCoreApplication.html#translate(java.lang.String, java.lang.String, java.lang.String)">QCoreApplication::translate()</a> function directly: <pre class="snippet">
        void some_static_function()
        {
            QLabel abel = new QLabel(
                        QApplication.instance().translate("LoginWidget", "Password:"));
        }
</pre><a name="use-qkeysequence-for-accelerator-values"><h3>Use QKeySequence() for Accelerator Values</h3> Accelerator values such as Ctrl+Q or Alt+F need to be translated too. If you hardcode <a href="../../../com/trolltech/qt/core/Qt.Modifier.html">Qt::CTRL</a> + <a href="../../../com/trolltech/qt/core/Qt.Key.html">Qt::Key_Q</a> for "quit" in your application, translators won't be able to override it. The correct idiom is <pre class="snippet">
     exitAct = new QAction(tr("E&xit"), this);
     exitAct.setShortcut(tr("Ctrl+Q", "Quit"));
</pre><a name="produce-translations"><h3>Produce Translations</h3> Once you are using tr() throughout an application, you can start producing translations of the user-visible text in your program. <p>The <a href="qtjambi-linguist-manual.html">Qt Linguist manual</a> provides further information about Qt Jambi's translation tools, Qt Linguist, <tt>lupdate</tt> and <tt>lrelease</tt>. <p>Translation of a Qt Jambi application is a three-step process: <ol><li> Run <tt>lupdate</tt> to extract translatable text from the Java source code of the Qt Jambi application, resulting in a message file for translators (a <tt>.ts</tt> file). The utility recognizes the tr() construct described above and produces <tt>.ts</tt> files (usually one per language).</li><li> Provide translations for the source texts in the <tt>.ts</tt> file, using Qt Linguist. Since <tt>.ts</tt> files are in XML format, you can also edit them by hand.</li><li> Run <tt>lrelease</tt> to obtain a light-weight message file (a <tt>.qm</tt> file) from the <tt>.ts</tt> file, suitable only for end use. Think of the <tt>.ts</tt> files as "source files", and <tt>.qm</tt> files as "object files". The translator edits the <tt>.ts</tt> files, but the users of your application only need the <tt>.qm</tt> files. Both kinds of files are platform and locale independent.</li></ol> Typically, you will repeat these steps for every release of your application. The <tt>lupdate</tt> utility does its best to reuse the translations from previous releases. <p>In your application, you must <a href="../../../com/trolltech/qt/core/QTranslator.html#load(java.lang.String, java.lang.String, java.lang.String)">QTranslator::load()</a> the translation files appropriate for the user's language, and install them using <a href="../../../com/trolltech/qt/core/QCoreApplication.html#installTranslator(com.trolltech.qt.core.QTranslator)">QCoreApplication::installTranslator()</a>. <p><tt>linguist</tt>, <tt>lupdate</tt> and <tt>lrelease</tt> are installed in the <tt>bin</tt> subdirectory of the base directory Qt Jambi is installed into. Click Help|Manual in Qt Linguist to access the user's manual; it contains a tutorial to get you started.<a name="qt-itself"> Qt itself contains over 400 strings that will also need to be translated into the languages that you are targeting. You will find translation files for French, German and Simplified Chinese in <tt>$QTDIR/translations</tt>, as well as a template for translating to other languages. (This directory also contains some additional unsupported translations which may be useful.) <p>Typically, your application's <tt>main()</tt> function will look like this: <pre class="snippet">
        public static void main(String args[])
        {
            QApplication.initialize(args);

            QTranslator qtTranslator = new QTranslator();
            qtTranslator.load("classpath:/translations_directory/qt_" + QLocale.system().name() + ".qm");
            QApplication.instance().installTranslator(tTranslator);


            QTranslator myappTranslator = new QTranslator();
            myappTranslator.load("classpath:/translations_directory/myapp_" + QLocale.system().name() + ".qm");
            QApplication.instance().installTranslator(myappTranslator);

            ...
            QApplication.exec();
        }
</pre><a name="localization"><a name="localize"><h3>Localize</h3> Localization is the process of adapting to local conventions, for example presenting dates and times using the locally preferred formats. Such localizations can be accomplished using appropriate tr() strings. <pre class="snippet">
        void setTime(QTime ime)
        {
            if (tr("AMPM") == "AMPM") {
                // 12-hour clock
            } else {
                // 24-hour clock
            }
        }
</pre> In the example, for the US we would leave the translation of "AMPM" as it is and thereby use the 12-hour clock branch; but in Europe we would translate it as something else and this will make the code use the 24-hour clock branch. <p>For localized numbers use the <a href="../../../com/trolltech/qt/core/QLocale.html">QLocale</a> class. <p>Localizing images is not recommended. Choose clear icons that are appropriate for all localities, rather than relying on local puns or stretched metaphors. The exception is for images of left and right pointing arrows which may need to be reversed for Arabic and Hebrew locales.<a name="dynamic-translation"><h2>Dynamic Translation</h2> Some applications, such as Qt Linguist, must be able to support changes to the user's language settings while they are still running. To make widgets aware of changes to the installed QTranslators, reimplement the widget's <a href="../../../com/trolltech/qt/gui/QWidget.html#changeEvent(com.trolltech.qt.core.QEvent)">changeEvent()</a> function to check whether the event is a <a href="../../../com/trolltech/qt/core/QEvent.Type.html">LanguageChange</a> event, and update the text displayed by widgets using the tr() function in the usual way. For example: <pre class="snippet">
    void changeEvent(QEvent vent)
    {
        if (e.type() == QEvent.Type.LanguageChange) {
            titleLabel.setText(tr("Document Title"));
            ...
            okPushButton.setText(tr("K"));
        } else
            QWidget.changeEvent(event);
    }
</pre> All other change events should be passed on by calling the default implementation of the function. <p>The list of installed translators might change in reaction to a <a href="../../../com/trolltech/qt/core/QEvent.Type.html">LocaleChange</a> event, or the application might provide a user interface that allows the user to change the current application language. <p>The default event handler for <a href="../../../com/trolltech/qt/gui/QWidget.html">QWidget</a> subclasses responds to the <a href="../../../com/trolltech/qt/core/QEvent.Type.html">QEvent::LanguageChange</a> event, and will call this function when necessary; other application components can also force widgets to update themselves by posting the <a href="../../../com/trolltech/qt/core/QEvent.Type.html">LanguageChange</a> event to them.<p /><address><hr /><div align="center">
 <table width="100%" cellspacing="0" border="0"><tr class="address">
 <td width="30%">Copyright &copy; 2009 Nokia Corporation and/or its subsidiary(-ies)</td>
 <td width="40%" align="center"><a href="trademarks.html">Trademarks</a></td>
 <td width="30%" align="right"><div align="right">Qt Jambi 4.5.2_01</div></td>
 </tr></table></div></address></body></html>
