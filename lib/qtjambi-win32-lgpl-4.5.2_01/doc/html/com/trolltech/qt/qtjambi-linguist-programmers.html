<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Qt Linguist Manual: Programmers</title><link href="classic.css" rel="stylesheet" type="text/css" />
</head><table border="0" cellpadding="0" cellspacing="0" width="100%">
 <tr>
 <td align="left" valign="top" width="32"> <img src="images/qt-logo.png" align="left" border="0" /> </td>
 <td width="1">&nbsp;&nbsp;</td> <td class="postheader" valign="center"> <a href="qtjambi-index.html"> <font color="#004faf">Home</font></a>&nbsp;&middot; <a href="qtjambi-examples.html"> <font color="#004faf">Examples</font></a>&nbsp; </td>
 </tr></table><body><p><hr><p><center><h1>Qt Linguist Manual: Programmers</h1></center><p>[Previous: <a href="qtjambi-linguist-translators.html">Qt Linguist Manual: Translators</a>][<a href="qtjambi-linguist-manual.html">Qt Linguist Manual</a>][Next: <a href="qtjambi-linguist-ts-file-format.html">Qt Linguist Manual: TS File Format</a>]<p> Support for multiple languages is extremely simple in Qt applications, and adds little overhead to the programmer's workload. <p>Qt minimizes the performance cost of using translations by translating the phrases for each window as they are created. In most applications the main window is created just once. Dialogs are often created once and then shown and hidden as required. Once the initial translation has taken place there is no further runtime overhead for the translated windows. Only those windows that are created, destroyed and subsequently created will have a translation performance cost. <p>Creating applications that can switch language at runtime is possible with Qt, but requires a certain amount of programmer intervention and will of course incur some runtime performance cost.<a name="making-the-application-translation-aware"><h2>Making the Application Translation-Aware</h2> Programmers should make their application look for and load the appropriate translation file and mark user-visible text and Ctrl keyboard accelerators as targets for translation. <p>Each piece of text that requires translating requires context to help the translator identify where in the program the text occurs. In the case of multiple identical texts that require different translations, the translator also requires some information to disambiguate the source texts. Marking text for translation will automatically cause the class name to be used as basic context information. In some cases the programmer may be required to add additional information to help the translator.<a name="creating-translation-files"><h3>Creating Translation Files</h3> Translation files consist of all the user-visible text and Ctrl key accelerators in an application and translations of that text. Translation files are created as follows: <ol><li> Run lupdate initially to generate the first set of <tt>.ts</tt> translation source files with all the user-visible text but no translations.</li><li> The <tt>.ts</tt> files are given to the translator who adds translations using Qt Linguist. Qt Linguist takes care of any changed or deleted source text.</li><li> Run lupdate to incorporate any new text added to the application. lupdate synchronizes the user-visible text from the application with the translations; it does not destroy any data.</li><li> Steps 2 and 3 are repeated as often as necessary.</li><li> When a release of the application is needed lrelease is run to read the <tt>.ts</tt> files and produce the <tt>.qm</tt> files used by the application at runtime.</li></ol> For lupdate to work successfully, it must know which translation files to produce. These are listed on the command-line. See the lupdate and lrelease sections.<a name="loading-translations"><h3>Loading Translations</h3> <pre class="snippet">
            setWindowTitle(String.format(tr("Language: %1$s"), tr("English")));
</pre> Loading a new <tt>.pm</tt> file is stright-forward. For a translation-aware application a translator object is created, a translation is loaded and the translator object installed into the application. <pre class="snippet">
            setWindowTitle(String.format(tr("Language: %1$s"), tr("English")));
</pre> In production applications a more flexible approach, for example, loading translations according to locale, might be more appropriate. If the <tt>.ts</tt> files are all named according to a convention such as appname_locale, e.g. <tt>myapp_fr.qm</tt>, <tt>myapp_de.qm</tt> etc, then the code above will load the current locale's translation at runtime. <p>If there is no translation file for the current locale the application will fall back to using the original source text. <p>Note that if you need to programmatically add translations at runtime, you can reimplement <a href="../../../com/trolltech/qt/core/QTranslator.html#translate(java.lang.String, java.lang.String)">QTranslator::translate()</a>.<a name="making-the-application-translate-user-visible-strings"><h3>Making the Application Translate User-Visible Strings</h3> User-visible strings are marked as translation targets by wrapping them in a <tt>tr()</tt> call, for example: <pre class="snippet">
        button = new QPushButton("&Quit", this);
</pre> would become <pre class="snippet">
        button = new QPushButton(tr("&Quit"), this);
</pre> QtJambiObject implements the <tt>tr()</tt> function, so all QtJambiObject subclasses can contain translated strings.<a name="distinguishing-identical-strings-that-require-different-translations"><h3>Distinguishing Identical Strings That Require Different Translations</h3> The lupdate program automatically provides a context for every source text. This context is the class name of the class that contains the <tt>tr()</tt> call. This is sufficient in the vast majority of cases. Sometimes however, the translator will need further information to uniquely identify a source text; for example, a dialog that contained two separate frames, each of which contained an "Enabled" option would need each identified because in some languages the translation would differ between the two. This is easily achieved using the two argument form of the <tt>tr()</tt> call, e.g. <pre class="snippet">
           rbc = new QRadioButton(tr("Enabled", "Color frame"), this);
</pre> and <pre class="snippet">
           rbh = new QRadioButton(tr("Enabled", "Hue frame"), this);
</pre> Ctrl key accelerators are also translatable: <pre class="snippet">
     exitAct = new QAction(tr("E&xit"), this);
     exitAct.setShortcut(tr("Ctrl+Q", "Quit"));
</pre> It is strongly recommended that the two argument form of <tt>tr()</tt> is used for Ctrl key accelerators. The second argument is the only clue the translator has as to the function performed by the accelerator.<a name="helping-the-translator-with-navigation-information"><h3>Helping the Translator with Navigation Information</h3> In large complex applications it may be difficult for the translator to see where a particular source text comes from. This problem can be solved by adding a comment using the keyword TRANSLATOR which describes the navigation steps to reach the text in question; e.g. <pre class="snippet">
        
            TRANSLATOR FindDialog

            Choose Edit|Find from the menu bar or press Ctrl+F to pop up the
            Find dialog.

            ...
</pre> These comments are particularly useful for widget classes.<a name="summary"><h2>Summary</h2> At the beginning of a project add the translation source files to be used to the project file and add calls to lupdate and lrelease to the makefile. <p>During the project all the programmer must do is wrap any user-visible text in <tt>tr()</tt> calls. They should also use the two argument form for Ctrl key accelerators, or when asked by the translator for the cases where the same text translates into two different forms in the same context. The programmer should also include <tt>TRANSLATION</tt> comments to help the translator navigate the application.<p /><address><hr /><div align="center">
 <table width="100%" cellspacing="0" border="0"><tr class="address">
 <td width="30%">Copyright &copy; 2009 Nokia</td>
 <td width="40%" align="center"><a href="trademarks.html">Trademarks</a></td>
 <td width="30%" align="right"><div align="right">Qt Jambi 4.5.2_01</div></td>
 </tr></table></div></address></body></html>
